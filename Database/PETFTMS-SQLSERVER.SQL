use PETFTMS;
go

CREATE TABLE HLV(
	MAHLV VARCHAR(5) NOT NULL,
	TENHLV NVARCHAR(50) NOT NULL,
	NGAYSINH DATE NOT NULL,
	GIOITINH CHAR(1) NOT NULL,
	CMND VARCHAR(12) NOT NULL,
	SDT VARCHAR(10) NOT NULL,
	DIACHI NVARCHAR(100) NOT NULL,
	NGAYVAOLAM DATE NOT NULL,
	HSLUONG REAL NOT NULL,
	CONSTRAINT PK_HLV PRIMARY KEY(MAHLV),
	CONSTRAINT CK_GT_HLV CHECK(GIOITINH IN('F', 'M')),
	CONSTRAINT CK_CMND_HLV CHECK(LEN(CMND) >= 9)
);

CREATE TABLE KHACHHANG(
	MAKHACH VARCHAR(5) NOT NULL,
	TENKHACH NVARCHAR(50) NOT NULL,
	NGAYSINH DATE NOT NULL,
	GIOITINH CHAR(1) NOT NULL,
	CMND VARCHAR(12) NOT NULL,
	SDT VARCHAR(10) NOT NULL,
	DIACHI NVARCHAR(100),
	CONSTRAINT PK_KHACH PRIMARY KEY(MAKHACH),
	CONSTRAINT CK_GT_KHACH CHECK(GIOITINH IN('F', 'M')),
	CONSTRAINT CK_CMND_KHACH CHECK(LEN(CMND) >= 9)
);

CREATE TABLE GIONG(
	MAGIONG VARCHAR(5) NOT NULL,
	TENGIONG NVARCHAR(20) NOT NULL,
	CAOTB REAL,
	NANGTB REAL,
	CONSTRAINT PK_GIONG PRIMARY KEY(MAGIONG)
);

CREATE TABLE PET(
	MAPET VARCHAR(5) NOT NULL,
	TENPET NVARCHAR(50) NOT NULL,
	NGAYSINH DATE NOT NULL,
	GIOITINH CHAR(1) NOT NULL,
	MAU NVARCHAR(10) NOT NULL,
	CANNANG REAL NOT NULL,
	CHIEUCAO FLOAT NOT NULL,
	MAGIONG VARCHAR(5) NOT NULL,
	MAKHACH VARCHAR(5) NOT NULL,
	CONSTRAINT PK_PET PRIMARY KEY(MAPET),
	CONSTRAINT CK_GT_PET CHECK(GIOITINH IN('F', 'M')),
	CONSTRAINT FK_PET_GIONG FOREIGN KEY(MAGIONG) REFERENCES GIONG(MAGIONG),
	CONSTRAINT FK_PET_KHACH FOREIGN KEY(MAKHACH) REFERENCES KHACHHANG(MAKHACH)
);

CREATE TABLE KHOAHOC(
	MAKHOA VARCHAR(8) NOT NULL,
	TENKHOA NVARCHAR(100) NOT NULL,
	LOAI NVARCHAR(20) NOT NULL,
	NGAYBATDAU DATE NOT NULL,
	THOILUONG REAL NOT NULL,
	DONGIA FLOAT NOT NULL,
	MAHLV VARCHAR(5) NOT NULL,
	MAPET VARCHAR(5) NOT NULL,
	CONSTRAINT PK_KHOA PRIMARY KEY(MAKHOA),
	CONSTRAINT FK_KHOA_HLV FOREIGN KEY(MAHLV) REFERENCES HLV(MAHLV),
	CONSTRAINT FK_KHOA_PET FOREIGN KEY(MAPET) REFERENCES PET(MAPET)
);

CREATE TABLE TAIKHOAN(
	ID INT IDENTITY(1,1) NOT NULL,
	TENDANGNHAP VARCHAR(50) NOT NULL,
	TENNV NVARCHAR(50) NOT NULL,
	MATKHAU VARCHAR(100) NOT NULL,
	QUYEN SMALLINT NOT NULL,
	CONSTRAINT PK_TK PRIMARY KEY(ID),
	CONSTRAINT U_TK UNIQUE(TENNV)
);

INSERT INTO TAIKHOAN(TENDANGNHAP,TENNV,MATKHAU,QUYEN) VALUES ('ADMIN','ADMIN','ADMIN',0);
INSERT INTO TAIKHOAN(TENDANGNHAP,TENNV,MATKHAU,QUYEN) VALUES ('MOD','MOD','MOD',1);